(function(P,C){typeof exports=="object"&&typeof module<"u"?C(exports):typeof define=="function"&&define.amd?define(["exports"],C):(P=typeof globalThis<"u"?globalThis:P||self,C(P.BlossomCarousel={}))})(this,function(P){"use strict";const C=(e,l)=>{let H=!0;const M={x:0,y:0},f={x:0,y:0},u={x:0,y:0},k=new Proxy({x:0,y:0},{set(t,n,i){return t[n]===i||(t[n]=i,(t.x>=10||t.y>=10)&&L(!0)),!0}}),r=new Proxy({x:!1,y:!1},{set(t,n,i){return t[n]===i||(t[n]=i,t.x||t.y?(e.setAttribute("has-overflow","true"),e.addEventListener("pointerdown",nt),e.addEventListener("wheel",ot,{passive:!1})):(e.removeAttribute("has-overflow"),e.removeEventListener("pointerdown",nt),e.removeEventListener("wheel",ot))),!0}});let x=300,y=null,d=!1,h=300,p=300,J=300,Q=300;const R={start:0,end:0},W={start:0,end:0};let Y=[],b=null,B=null,X=null,V=!1,O,v=1,w={target:null,x:0};function pt(){e==null||e.setAttribute("blossom-carousel","true"),b=(e==null?void 0:e.querySelectorAll("a[href]"))||null,b==null||b.forEach(i=>{i.addEventListener("click",Z)}),window.addEventListener("keydown",st),e.addEventListener("scroll",et),B=new ResizeObserver(tt),B.observe(e),X=new MutationObserver(xt),X.observe(e,{attributes:!1,childList:!0,subtree:!1});const t=window.matchMedia("(hover: hover) and (pointer: fine)").matches;v=e.closest('[dir="rtl"]')?-1:1;const{scrollSnapType:n}=window.getComputedStyle(e);V=n!=="none",e.style.setProperty("--snap-type",n),t&&(e.style["scroll-snap-type"]="none"),e.setAttribute("has-repeat",l!=null&&l.repeat?"true":"false"),O=St(i=>{(i===e||e.contains(i))&&L(!1)})}function ht(){e.removeAttribute("blossom-carousel"),B==null||B.disconnect(),X==null||X.disconnect(),y&&cancelAnimationFrame(y),window.removeEventListener("keydown",st),e.removeEventListener("scroll",et),b==null||b.forEach(t=>{t.removeEventListener("click",Z)}),O==null||O()}function Z(t){k.x>10&&t.preventDefault()}function tt(){if(!e)return;const t="ontouchmove"in window;h=e.scrollWidth,p=e.clientWidth,J=e.scrollHeight,Q=e.clientHeight;const n=window.getComputedStyle(e);r.x=!t&&h>p&&["auto","scroll"].includes(n.getPropertyValue("overflow-x")),r.y=!t&&J>Q&&["auto","scroll"].includes(n.getPropertyValue("overflow-y")),R.end=parseInt(n.paddingInlineEnd)||0,R.start=parseInt(n.paddingInlineStart)||0,W.start=parseInt(n.scrollPaddingInlineStart)||0,W.end=parseInt(n.scrollPaddingInlineEnd)||0,v=e.closest('[dir="rtl"]')?-1:1,x=(h-p-4)*v,Y=V?yt(e):[],l!=null&&l.repeat&&j(null,null)}function xt(){tt()}function yt(t){let n=[],i=0;const s=o=>{if(i++,i>100)return;const c=window.getComputedStyle(o).scrollSnapAlign;if(c!=="none"){n.push({align:c,el:o});return}const E=o.children;if(E.length!==0)for(let F of E)s(F)};s(t);const U=t.getBoundingClientRect();return n.map(({el:o,align:m},c)=>{const E=o.getBoundingClientRect(),F=o.clientWidth,K=E.left-U.left+t.scrollLeft;switch(m){case"start":return{target:o,x:K-W.start};case"end":return{target:o,x:K+F-p+W.end};case"center":return{target:o,x:K+F*.5-p/2};default:return null}}).filter(o=>o!==null).reduce((o,m)=>((o.length===0||o[o.length-1].x!==m.x)&&o.push(m),o),[])}function et(){if(l!=null&&l.repeat){j(null,null);return}if(d||!e)return;const t=e.scrollLeft;if(t<0){const n=t*-1;G(n)}else if(t>h-p){const n=t*-1+h-p;G(n)}}const a={x:0,y:0};function nt(t){e&&(r.x&&(a.x=e.scrollLeft,M.x=t.clientX,u.x=0),r.y&&(a.y=e.scrollTop,M.y=t.clientY,u.y=0),k.x=0,d=!0,window.addEventListener("pointermove",it),window.addEventListener("pointerup",at))}function it(t){if(t.preventDefault(),r.x){const n=M.x-t.clientX;f.x+=n,u.x+=n,M.x=t.clientX,k.x+=Math.abs(n)}if(r.y){const n=M.y-t.clientY;f.y+=n,u.y+=n,M.y=t.clientY,k.y+=Math.abs(n)}}function at(){window.removeEventListener("pointermove",it),window.removeEventListener("pointerup",at),d=!1,!(k.x<=10)&&(r.x&&(u.x*=2),r.y&&(u.y*=2),vt(),Pt())}function ot(t){if(Math.abs(t.deltaX)>Math.abs(t.deltaY)){if(L(!1),d||!e)return;r.x&&(a.x=e.scrollLeft),r.y&&(a.y=e.scrollTop)}}function st(t){["ArrowLeft","ArrowRight","ArrowUp","ArrowDown"].includes(t.key)&&L(!1)}function vt(){const t=ct({axis:"x"});t.x!==w.x&&ut(t),w=t;const s=(dt(t.x,Math.min((h-p)*v,0),Math.max((h-p)*v,0))-f.x)*(1-S)*(1/S);u.x=s}function j(t,n){if(!e)return;const i=n??e.scrollLeft,s=R.start-i,U=i-(h-p-R.end),g=Array.from(e.children);let z=0;for(let c=g.length-1;c>=g.length/2;c--){const E=z>s?0:-(h-p);z+=g[c].clientWidth,g[c].style.translate=`${E}px 0`}let o=0;for(let c=0;c<g.length/2;c++){const E=o>U?0:h-p;o+=g[c].clientWidth,g[c].style.translate=`${E}px 0`}if(d)return;const m=i>x?4:i<4?x:null;m&&(A=!0,e.scrollTo({left:m,behavior:"instant"}))}function lt(t){_&&t.stopPropagation()}const S=.72,q=.12;let _=!1;function L(t){e&&(t&&!_?($=performance.now(),r.x&&(f.x=e.scrollLeft),r.y&&(f.y=e.scrollTop),e.addEventListener("scrollend",lt,{capture:!0,passive:!1}),y||(y=requestAnimationFrame(rt))):t||(y&&cancelAnimationFrame(y),y=null,e.removeEventListener("scrollend",lt)),_=t,H=!t,e.setAttribute("has-snap",H?"true":"false"))}let T=0,$=0;function rt(t){if(y=requestAnimationFrame(rt),T=t-$,!!e){if(r.x&&(u.x*=S,d?a.x=D(a.x,f.x,S,T):(f.x+=u.x,a.x=D(a.x,f.x,q,T))),r.y&&(u.y*=S,d?a.y=D(a.y,f.y,S,T):(f.y+=u.y,a.y=D(a.y,f.y,q,T))),l!=null&&l.repeat&&(a.x>x&&(a.x=f.x=4),a.x<4&&(a.x=f.x=x)),A=!0,e.scrollTo({left:a.x,top:a.y,behavior:"instant"}),d&&V){const n=ct({axis:"x"});n.x!==w.x&&(w=n,ut(n))}!d&&N(u.x,8)===0&&(L(!1),gt(),V&&mt()),l!=null&&l.repeat?j(null,a.x):wt(N(a.x,2)),$=t}}let I=0;function wt(t){if(!e)return;const n=x;let i=0;if(t*v<=0?i=d?t*-.2:0:t*v>n*v&&(i=d?(t-n)*-.2:0),I=D(I,i,d?.8:q,T),Math.abs(I)>.01){if(G(I).defaultPrevented)return;e.style.transform=`translateX(${N(I,3)}px)`;return}e.style.transform="",I=0}function G(t){const n=new CustomEvent("overscroll",{bubbles:!0,cancelable:!0,detail:{left:t}});return e==null||e.dispatchEvent(n),n}const ft=new Event("scrollend",{bubbles:!0,cancelable:!0});function gt(){return e==null||e.dispatchEvent(ft),ft}function mt(){const t=new CustomEvent("scrollsnapchange",{bubbles:!0,cancelable:!0,detail:{snapTargetInline:w.target,snapTargetBlock:w.target}});return e==null||e.dispatchEvent(t),t}function ut(t){const n=new CustomEvent("scrollsnapchanging",{bubbles:!0,cancelable:!0,detail:{snapTargetInline:(t||w).target,snapTargetBlock:(t||w).target}});return e==null||e.dispatchEvent(n),n}let A=!1;const Et=e.scrollTo.bind(e);e.scrollTo=function(t){A===!0||L(!1),A=!1,Et(t)};const bt=e.scrollBy.bind(e);e.scrollBy=function(t){A===!0||L(!1),A=!1,bt(t)};function St(t){const n=[],i=Element.prototype.scrollIntoView;return i&&(Element.prototype.scrollIntoView=function(s){return t(this,"scrollIntoView",[s]),i.call(this,s)},n.push(()=>{Element.prototype.scrollIntoView=i})),()=>n.forEach(s=>s())}function Lt({axis:t="x"}){return f[t]+u[t]/(1-S)}function ct({axis:t="x"}){const n=Lt({axis:t});return Y.length?Y.reduce((i,s)=>Math.abs(s.x-n)<Math.abs(i.x-n)?s:i):{target:null,x:dt(n,Math.min(x,0),Math.max(x,0))}}function Pt(){const t=n=>{n.preventDefault(),n.stopPropagation(),window.removeEventListener("click",t,!0)};window.addEventListener("click",t,!0)}function Mt(t,n,i){return(1-i)*t+i*n}function D(t,n,i,s){return Mt(t,n,1-Math.exp(Math.log(1-i)*(s/16.666666666666668)))}function dt(t,n,i){return t<n?n:t>i?i:t}function N(t,n=0){const i=Math.pow(10,n);return Math.round(t*i)/i}return{snap:H,hasOverflow:r,init:pt,destroy:ht}};P.Blossom=C,Object.defineProperty(P,Symbol.toStringTag,{value:"Module"})});
